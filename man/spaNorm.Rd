% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spaNorm.R
\name{SpaNorm}
\alias{SpaNorm}
\title{Spatially-dependent normalisation for spatial transcriptomics datas}
\usage{
SpaNorm(
  spe,
  sample.p = 0.25,
  gene.model = c("nb"),
  scale.factor = 1,
  df.tps = 6,
  lambda.a = 1e-04,
  ...
)
}
\arguments{
\item{spe}{a SpatialExperiment or Seurat object, with the count data stored in 'counts' or 'data' assays respectively.}

\item{sample.p}{a numeric, specifying the (maximum) proportion of cells/spots to sample for model fitting (default is 0.25).}

\item{gene.model}{a character, specifying the model to use for gene/protein abundances (default 'nb'). This should be 'nb' for count based datasets.}

\item{scale.factor}{a numeric, specifying the sample-specific scaling factor to scale the adjusted count.}

\item{df.tps}{a numeric, specifying the degrees of freedom for the thin-plate spline (default is 6).}

\item{lambda.a}{a numeric, specifying the smoothing parameter for regularizing regression coefficients (default is 0.0001). Actual lambda.a used is lambda.a * ncol(spe).}

\item{...}{other parameters to pass to SpaNorm.}

\item{step.factor}{a numeric, specifying the multiplicative factor to decrease IRLS step by when log-likelihood diverges (default is 0.5).}

\item{inner.maxit}{a numeric, specifying the maximum number of IRLS iteration for estimating mean parameters for a given dispersion parameter (default is 50).}

\item{outer.maxit}{a numeric, specifying the maximum number of IRLS iteration (default is 25).}
}
\value{
a SpatialExperiment or Seurat object with the adjusted data stored in 'logcounts' or ''
}
\description{
Performs normalisation of spatial transcriptomics data using spatially-dependent spot-specific size factor.
}

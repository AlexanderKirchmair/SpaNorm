% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spaNorm.R
\name{spaNorm}
\alias{spaNorm}
\title{spatially-dependent normalisation for spatial transcriptomics data}
\usage{
spaNorm(
  spe,
  lambda.a = 1e-04,
  step.fac = 0.5,
  inner.maxit = 50,
  outer.maxit = 25
)
}
\arguments{
\item{spe}{SpatialExperiment object with the raw data stored in assays(spe)$counts}

\item{lambda.a}{smoothing parameter for regularizing regression coefficients. The default is 0.0001*ncol(spe)}

\item{step.fac}{multiplicative factor to decrease IRLS step by when log-likelihood diverges. Default is 0.5}

\item{inner.maxit}{the maximum number of IRLS iteration for estimating mean parameters for a given dispersion parameter. Default is 50}

\item{outer.maxit}{the maximum number of IRLS iteration. Default is 25}
}
\value{
SpatialExperiment object with the adjusted data stored in assays(spe)$logPAC
}
\description{
Performs normalisation of spatial transcriptomics data using spatially-dependent spot-specific size factor.
}

\examples{
data(HumanDLPFC)
HumanDLPFC
HumanDLPFC <- spaNorm(spe=HumanDLPFC)
HumanDLPFC <- scater::runUMAP(HumanDLPFC, exprs_values='logPAC')
p <- scater::plotUMAP(HumanDLPFC, colour_by='AnnotatedCluster')
p
}



% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spaNorm.R
\name{spaNorm}
\alias{spaNorm}
\title{spatially-dependent normalisation for spatial transcriptomics datas}
\usage{
spaNorm(
  spe,
  pCells.touse = 0.25,
  lambda.a = 1e-04,
  scale.factor = 1,
  step.fac = 0.5,
  inner.maxit = 50,
  outer.maxit = 25
)
}
\arguments{
\item{spe}{SpatialExperiment object with the raw data stored in assays(spe)$counts}

\item{pCells.touse}{the (maximum) proportion of cells used for model fitting. The default is 0.25.}

\item{lambda.a}{smoothing parameter for regularizing regression coefficients. The default is 0.0001*ncol(spe)}

\item{scale.factor}{scaling factor to scale the adjusted count by.}

\item{step.fac}{multiplicative factor to decrease IRLS step by when log-likelihood diverges. Default is 0.5}

\item{inner.maxit}{the maximum number of IRLS iteration for estimating mean parameters for a given dispersion parameter. Default is 50}

\item{outer.maxit}{the maximum number of IRLS iteration. Default is 25}
}
\value{
SpatialExperiment object with two forms of adjusted data: the log percentile-adjusted adjusted count (Salim et al., NAR 2002) in the in assays(spe)$logPAC slot and the log mean biological expression stored in assays(spe)$logmBIO slot.
}
\description{
Performs normalisation of spatial transcriptomics data using spatially-dependent spot-specific size factor.
}

\examples{
data(HumanDLPFC)
HumanDLPFC
HumanDLPFC <- spaNorm(spe=HumanDLPFC)
HumanDLPFC <- scater::runUMAP(HumanDLPFC, exprs_values='logPAC')
p <- scater::plotUMAP(HumanDLPFC, colour_by='AnnotatedCluster')
p
}

